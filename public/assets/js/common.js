!function(e){"function"==typeof define&&define.amd?define("commonBundle",e):e()}(function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,a,i){return a&&t(e.prototype,a),i&&t(e,i),e}!function(t,i,c){var s=function(){function t(){e(this,t),this.stack=[],this.started=!1,this.sorted=!1}return a(t,[{key:"use",value:function(e,a){var i=this;e=t.normalizeScope(e),this.sorted||(this.stack.sort(function(e,t){return e.order===t.order?0:e.order>t.order?1:-1}),this.sorted=!0),this.stack.filter(function(t){return e.some(function(e){return t.scope.indexOf(e)>-1})}).map(function(t){return t.callback.call(i,a,e)})}},{key:"bind",value:function(e,a,i){void 0===i&&(void 0===a?(a=e,e=["default"]):"number"==typeof a&&(i=a||0,a=e,e=["default"])),void 0===i&&(i=0),e=t.normalizeScope(e),this.stack.push({scope:e,callback:a,order:i}),this.sorted=!1}},{key:"start",value:function(){var e=this;!1===this.started&&(this.started=!0,i(function(){e.use("default")}))}}],[{key:"normalizeScope",value:function(e){return"string"==typeof e&&(e=e.split(" ").map(function(e){return e.trim()})),0===e.length&&(e=["default"]),e}}]),t}();t.app=new s}(window,jQuery),app.bind("default",function(){$(".promotions__slider").slick({variableWidth:!0,centerMode:!0,centerPadding:"0",infinite:!0,appendArrows:$(".promotions__buttons"),prevArrow:'<a href="" class="promotions__button promotions__button_left" role="button"></a>',nextArrow:'<a href="" class="promotions__button promotions__button_right" role="button"></a>'}),$(".videos__list").slick({variableWidth:!0,infinite:!1,arrows:!1}),$("[js-scrolltop]").on("click",function(e){$("html, body").animate({scrollTop:0},500),e.preventDefault(),e.stopPropagation()}),$("[js-toggler]").toggler(),$("[js-tabby-tab]").tabby(),$("[js-contacts-image-item]").on("click",function(){$("[js-contacts-image][data-id = "+$(this).data("target")+"]").children("img").attr("src",$(this).data("full-img"))})}),app.bind("default",function(){$("input[name=tel]").inputmask({mask:"+7 (999) 999-99-99",jitMasking:4,showMaskOnHover:!1,showMaskOnFocus:!1,undoOnEscape:!1,oncomplete:function(){$(this).parent().removeClass("is-error"),$(this).parent().siblings("[type=submit]").prop("disabled",!1)},onincomplete:function(){$(this).parent().addClass("is-error"),$(this).parent().siblings("[type=submit]").prop("disabled",!0)}}),$("[js-callback-form]").on("submit",function(e){var t=$(this),a={};$("input[name=price]",t).val(function(){var e="";return $(".catalog-item.is-active").not(".catalog-item_static").each(function(){$(".catalog-item__description",this).text()?e+=$(".catalog-item__description",this).text()+"; ":e+=$(".catalog-item__name",this)[0].innerText+"; "}),e}),$(t.serializeArray()).each(function(e,t){a[t.name]=t.value}),a.district&&(a.district=a.district.split(";")[2]),$.ajax({type:"POST",timeout:1e3,cache:!1,data:{callback:a},dataType:"json",success:function(e){e.success?$(".layer-callback__title",t.parent()).text("Мы свяжемся с Вами в ближайшее время!"):$(".layer-callback__title",t.parent()).text("Произошла ошибка, повторите попытку позже."),t.parent().addClass("is-completed")},error:function(){$(".layer-callback__title",t.parent()).text("Произошла ошибка, повторите попытку позже."),t.parent().addClass("is-completed")}}),e.preventDefault(),e.stopPropagation()})}),app.bind("default",function(){$("[js-selectize]").each(function(){var e=$(this),t=$("select",e).selectize()[0].selectize,a=$(".selectize__button",e);a.on("click",function(){t.clear(),a.removeClass("selectize__button_active")}),t.on("change",function(){var e=this.getValue();e?$(window).width()>850?$.ajax({type:"POST",timeout:1e3,cache:!1,data:{model:e},dataType:"json",success:function(i){if(i.success){if(a.addClass("selectize__button_active"),i.img?$(".base-product-card__img img").attr("src",i.img):$(".base-product-card__img img").attr("src",""),$(".base-review-card__footer-button").attr("href",e),$(".base-product-card__name span").text(i.name),$(".base-review-card__items").empty(),Array.isArray(i.items))for(var c=0;c<i.items.length;c++){var s=$('<div class="base-review-card__item base-review-card-item"></div>');s.append('<span class="base-review-card-item__name">'+i.items[c].name+"</span>"),i.items[c].time?s.append('<span class="base-review-card-item__time">'+i.items[c].time+" мин.</span>"):s.append('<span class="base-review-card-item__time">уточняйте</span>');var n=$('<div class="base-review-card-item__price"></div>');i.items[c].price?n.append('<span class="base-review-card-item__current-price">'+i.items[c].price+" ₽</span>"):n.append('<span class="base-review-card-item__current-price">уточняйте</span>'),i.items[c].price_old&&n.append('<span class="base-review-card-item__old-price">'+i.items[c].price_old+" ₽</span>"),s.append(n),$(".base-review-card__items").append(s)}$(".base__side").addClass("is-active"),$(".base-product-card__name").textfill(),$(".base-product-card__name").textfill(),$(".base-product-card__name").textfill(),$(".base-product-card__name").textfill(),$(".base-product-card__name").textfill(),$(".base-product-card__name").textfill()}else t.clear(),a.removeClass("selectize__button_active"),$(".base__side").removeClass("is-active")},error:function(){t.clear(),a.removeClass("selectize__button_active"),$(".base__side").removeClass("is-active")}}):(a.addClass("selectize__button_active"),document.location.pathname="/"+e):(t.clear(),a.removeClass("selectize__button_active"),$(".base__side").removeClass("is-active")),t.blur()}),new SimpleBar($(".selectize-dropdown",e)[0])})}),app.bind("default",function(){$("[js-district]").each(function(){var e=$(this),t=$("select",e).selectize()[0].selectize,a=$(".selectize__button",e),i=$(".layer-callback__price span");i.data("originalValue",i.text()),a.on("click",function(){t.clear(),a.removeClass("selectize__button_active")}),t.on("change",function(){var e=this.getValue().split(";")[1];e?(a.addClass("selectize__button_active"),i.text(e+"₽")):(t.clear(),a.removeClass("selectize__button_active"),i.text(i.data("originalValue"))),t.blur()})})}),app.bind("default",function(){function e(){var e=$(".catalog-item.is-active").not(".catalog-item_static");if(e.length){var t=0,a=0,i=0,c=0;$(".catalog-selected").addClass("is-active"),e.each(function(){var e=$(this);t<e.data("warranty")&&(t=e.data("warranty")),a<e.data("time")&&(a=e.data("time")),i+=Number(e.data("price")),Number(e.data("price-old"))?c+=Number(e.data("price-old")):c+=Number(e.data("price"))}),t>0?$(".catalog-selected-info__warranty-number").text(t+" мес"):$(".catalog-selected-info__warranty-number").text("-"),a>0?$(".catalog-selected-info__time-number").text(a+" мин"):$(".catalog-selected-info__time-number").text("-"),c>0?$(".catalog-selected-info__price-old").text(c+" ₽"):$(".catalog-selected-info__price-old").text(""),i>0?($("[js-catalog-selected-input]").prop("checked")&&(i+=490),$(".catalog-selected-info__price-current").text(i+" ₽")):$(".catalog-selected-info__price-current").text("уточняйте"),i>3e3?$(".catalog-selected-info__button_credit").addClass("is-active").data("price",i):$(".catalog-selected-info__button_credit").removeClass("is-active")}else $(".catalog-selected").removeClass("is-active")}$("[js-catalog-item-input]").on("change",function(){var t=$(this),a=t.parents("[js-catalog-item]");this.checked?($(".catalog-selected__items").append($('<div class="catalog-selected__item catalog-selected-item" data-id="'+a.data("id")+'"><div class="catalog-selected-item__name">'+$.trim($(".catalog-item__name",a)[0].innerText)+'</div><div class="catalog-selected-item__warranty"><div class="catalog-selected-item__warranty-text">Гарантия</div><div class="catalog-selected-item__warranty-number">'+$(".catalog-item__warranty-number",a).text()+'</div></div><div class="catalog-selected-item__time"><div class="catalog-selected-item__time-text">Сроки</div><div class="catalog-selected-item__time-number">'+$(".catalog-item__time-number",a).text()+'</div></div><a href="#" class="catalog-selected-item__button"></a></div>')),a.addClass("is-active")):($(".catalog-selected-item[data-id = "+a.data("id")+"]").remove(),a.removeClass("is-active")),e(),$(window).scroll()}),$(".catalog-selected__items").on("click",".catalog-selected-item__button",function(t){$("[js-catalog-item][data-id = "+$(this).parent().data("id")+"]").removeClass("is-active").find("[js-catalog-item-input]").prop("checked",!1),$(this).parent().remove(),e(),t.preventDefault(),t.stopPropagation()}),$("[js-catalog-selected-input]").on("click",function(){e()}),$("[js-catalog-submit]").on("click",function(){$("[js-catalog-selected-input]").prop("checked")?Layer.open("main/callback-out"):Layer.open("main/callback")}),$("[js-catalog-credit]").on("click",function(){var e=$(".catalog-item.is-active").not(".catalog-item_static"),t=[],a=0;e.length&&(e.each(function(){var e,i,c=$(this);e=$(".catalog-item__description",c).text()?$(".catalog-item__description",c).text():$(".catalog-item__name",c)[0].innerText,i=Number(c.data("price")),a+=i,t.push({name:e,price:i,quantity:1})}),$("[js-catalog-selected-input]").prop("checked")&&(t.push({name:"Выезд мастера",price:490,quantity:1}),a+=490),tinkoff.create({sum:a,items:t,shopId:"f797b066-7db8-4ee9-8d65-716f2840b849",showcaseId:"abe9f0a4-4fc4-412f-aee2-aac0d7432476"},{view:"newTab"}))}),$(".catalog-selected_fixed")[0]&&$(window).on("scroll",function(){var e=$(window),t=$(".catalog-selected_fixed");t.hasClass("is-active")&&t.parent().offset()&&t.parent().offset().top+30>e.scrollTop()+e.height()?$(".catalog-selected_fixed").removeClass("is-hide"):$(".catalog-selected_fixed").addClass("is-hide")})}),app.bind("default",function(){$("[js-layer]").layer()})});